---
import HeaderLink from './HeaderLink.astro';
import LogoWordmark from './LogoWordmark.astro';
import TalkAvatarBadge from './TalkAvatarBadge.astro';
import { withBase } from '../utils/paths';

const homeHref = withBase('/');
const aboutHref = withBase('/about');

const navLinks = [
	{ href: '/', label: 'Home' },
	{ href: '/blog', label: 'Blog' },
	{ href: '/projects', label: 'Projetos' },
	{ href: '/talk', label: 'Talks' },
	{ href: '/tags', label: 'Tags' },
];
---

<header class="site-header">
	<div class="page-shell">
		<div class="nav-bar">
			<div class="nav-leading">
				<a href={homeHref} aria-label="Ir para a página inicial" class="logo-link">
					<LogoWordmark />
				</a>
			</div>
				<nav class="nav-links desktop-nav">
					{navLinks.map((link) => (
						<HeaderLink href={link.href}>{link.label}</HeaderLink>
					))}
				</nav>
				<div class="nav-cta">
					<a class="nav-avatar-link" href={aboutHref} aria-label="Ir para a página Sobre">
						<TalkAvatarBadge />
					</a>
					<details class="mobile-menu">
						<summary class="mobile-menu__toggle">
							<span class="sr-only">Abrir menu de navegação</span>
							<span aria-hidden="true" class="hamburger">
								<span></span>
								<span></span>
								<span></span>
							</span>
						</summary>
						<div class="mobile-menu__panel">
							{navLinks.map((link) => (
								<HeaderLink class="mobile-menu__link" href={link.href}>
									{link.label}
								</HeaderLink>
							))}
						</div>
					</details>
				</div>
		</div>
	</div>
</header>

<style>
	.site-header {
		position: sticky;
		top: 0;
		z-index: 10;
		backdrop-filter: blur(16px);
		background: rgba(5, 5, 8, 0.85);
		border-bottom: 1px solid rgba(255, 255, 255, 0.05);
		box-shadow: 0 12px 30px rgba(0, 0, 0, 0.45);
	}

	.nav-bar {
		position: relative;
		display: flex;
		align-items: center;
		justify-content: space-between;
		padding: 1.25rem 0;
		gap: 2rem;
	}

	.nav-leading {
		display: flex;
		align-items: center;
		gap: 1.5rem;
		flex: 0 0 auto;
	}

	.logo-link {
		display: flex;
		align-items: center;
		color: var(--color-fg);
	}

	.nav-links {
		display: flex;
		align-items: center;
		gap: 2rem;
	}

	.mobile-menu {
		display: none;
		position: static;
		flex-direction: column;
	}

	.mobile-menu__toggle {
		list-style: none;
		cursor: pointer;
		display: inline-flex;
		align-items: center;
		justify-content: center;
		width: 3.25rem;
		height: 3.25rem;
		margin: 0;
		border-radius: 999px;
		border: 1px solid rgba(255, 255, 255, 0.12);
		background: radial-gradient(circle at 30% 20%, rgba(154, 26, 255, 0.3), rgba(110, 110, 255, 0.15));
		box-shadow: 0 18px 40px rgba(0, 0, 0, 0.55);
		transition: transform 0.25s ease, box-shadow 0.25s ease;
	}

	.mobile-menu__toggle::-webkit-details-marker {
		display: none;
	}

	.mobile-menu[open] .mobile-menu__toggle {
		transform: translateY(-1px);
		box-shadow: 0 24px 45px rgba(0, 0, 0, 0.6);
	}

	.hamburger {
		display: inline-flex;
		flex-direction: column;
		gap: 0.35rem;
	}

	.hamburger span {
		display: block;
		width: 1.5rem;
		height: 2px;
		background: linear-gradient(120deg, #00ff7f, #6e6eff);
		border-radius: 999px;
		transition: background 0.25s ease;
	}

	.mobile-menu__panel {
		position: absolute;
		top: calc(100% + 0.75rem);
		left: 0;
		right: 0;
		width: 100%;
		padding: 0.75rem 0.5rem;
		display: flex;
		flex-direction: column;
		gap: 0.35rem;
		z-index: 5;
		background: rgba(8, 8, 14, 0.96);
		border: 1px solid rgba(255, 255, 255, 0.08);
		box-shadow: 0 24px 60px rgba(0, 0, 0, 0.65);
		backdrop-filter: blur(18px);
	}

	.mobile-menu__link {
		display: block;
		width: 100%;
		text-align: left;
		padding: 0.6rem 0;
		border-radius: 0;
		border-bottom: 1px solid rgba(255, 255, 255, 0.08);
	}

	.mobile-menu__link:hover {
		color: var(--color-fg);
	}

	.mobile-menu__link:last-child {
		border-bottom: none;
	}

	.mobile-menu:not([open]) .mobile-menu__panel {
		display: none;
	}

	.nav-cta {
		display: flex;
		align-items: center;
		justify-content: flex-end;
		gap: 0.65rem;
	}

	.nav-cta > .nav-avatar-link {
		order: 1;
	}

	.nav-cta > .mobile-menu {
		order: 2;
		margin-left: 0.35rem;
	}

	.nav-avatar-link {
		display: inline-flex;
		padding: 0.35rem 0.6rem;
		border-radius: 999px;
		background: rgba(4, 4, 6, 0.85);
		box-shadow: 0 14px 30px rgba(0, 0, 0, 0.55);
		transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
	}

	.nav-avatar-link:hover {
		transform: translateY(-1px);
		box-shadow: 0 18px 40px rgba(0, 0, 0, 0.6);
	}

	@media (max-width: 820px) {
		.nav-bar {
			flex-direction: row;
			align-items: center;
			gap: 0.5rem;
			flex-wrap: wrap;
		}
		.nav-leading {
			flex: 1 1 auto;
			min-width: 0;
			justify-content: flex-start;
			gap: 0.5rem;
		}
		.logo-link {
			flex: 0 0 auto;
		}
		.desktop-nav {
			display: none;
		}
		.mobile-menu {
			display: inline-flex;
			align-items: center;
		}
		.mobile-menu__toggle {
			width: 2.35rem;
			height: 2.35rem;
			align-self: center;
		}
		.mobile-menu__link {
			padding: 0.65rem 0;
		}
		.nav-links {
			order: 3;
			width: 100%;
		}
		.nav-cta {
			order: 2;
			align-self: center;
		}
		.nav-avatar-link {
			padding: 0.3rem 0.5rem;
		}
	}
</style>
